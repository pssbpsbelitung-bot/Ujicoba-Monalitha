<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Dashboard Monitoring Harga</title>
<style>
body {
  font-family: Arial, sans-serif;
  background: #f4f6f9;
  margin: 0;
  padding: 20px;
}

h1 {
  margin-bottom: 20px;
}

.container {
  display: grid;
  grid-template-columns: 260px 1fr;
  gap: 20px;
}

.sidebar {
  display: flex;
  flex-direction: column;
  gap: 15px;
}

.card {
  background: #fff;
  padding: 15px;
  border-radius: 8px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.1);
}

.card h3 {
  margin-top: 0;
  font-size: 14px;
  color: #555;
}

select {
  width: 100%;
  padding: 8px;
}

.main {
  display: flex;
  flex-direction: column;
  gap: 20px;
}

.kpi {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 15px;
}

.kpi .value {
  font-size: 22px;
  font-weight: bold;
  color: #0d6efd;
}

.fenomena-item {
  margin-bottom: 15px;
  border-bottom: 1px solid #ddd;
  padding-bottom: 10px;
}

.fenomena-item:last-child {
  border-bottom: none;
}
</style>
</head>

<body>

<h1>Dashboard Monitoring Harga</h1>

<div class="container">

  <!-- SIDEBAR -->
  <div class="sidebar">

    <div class="card">
      <h3>Pilih Bulan</h3>
      <select id="monthSelect">
        <option value="">-- Pilih Bulan --</option>
      </select>
    </div>

    <div class="card">
      <h3>Pilih Komoditas</h3>
      <select id="komoditasSelect">
        <option value="">-- Semua Komoditas --</option>
      </select>
    </div>

    <div class="card">
      <h3>Pilih Jenis Kegiatan</h3>
      <select id="kegiatanSelect">
        <option value="">-- Semua Kegiatan --</option>
      </select>
    </div>

    <!-- KPI DIPINDAHKAN KE SINI -->
    <div class="card">
      <h3>Rata-rata Perubahan Harga (%)</h3>
      <div class="value" id="avgChange">-</div>
    </div>

    <div class="card">
      <h3>Perubahan Terpilih</h3>
      <div class="value" id="selectedChange">-</div>
    </div>

  </div>

  <!-- MAIN CONTENT -->
  <div class="main">

    <div class="kpi">
      <div class="card">
        <h3>Jumlah Komoditas</h3>
        <div class="value" id="jumlahKomoditas">0</div>
      </div>
      <div class="card">
        <h3>Jumlah Fenomena</h3>
        <div class="value" id="jumlahFenomena">0</div>
      </div>
      <div class="card">
        <h3>Bulan Aktif</h3>
        <div class="value" id="bulanAktif">-</div>
      </div>
    </div>

    <div class="card">
      <h3>Fenomena Perubahan Harga</h3>
      <div id="fenomenaList"></div>
    </div>

    <div class="card">
      <h3>Perbandingan Harga</h3>
      <p>(grafik placeholder)</p>
    </div>

  </div>
</div>

<script>
/* ================= DATA ================= */
const data = [
  {
    bulan: "Januari",
    komoditas: "Sapi bali berat 400kg",
    kegiatan: "SHPB BULANAN",
    hargaSebelum: 22000000,
    hargaSekarang: 25000000,
    alasan: "Kendala di pengiriman yang agak susah"
  },
  {
    bulan: "Januari",
    komoditas: "Bawang merah batu 1 karung x 30 kg",
    kegiatan: "SHPB MINGGUAN",
    hargaSebelum: 1230000,
    hargaSekarang: 840000,
    alasan: "Harga turun dikarenakan pasokan barang banyak"
  },
  {
    bulan: "Januari",
    komoditas: "Cabe rawit lokal 1 karung x 25 kg",
    kegiatan: "SHPB MINGGUAN",
    hargaSebelum: 2825000,
    hargaSekarang: 2450000,
    alasan: "Harga turun dikarenakan pasokan barang banyak"
  }
];

/* ================= ELEMENT ================= */
const monthSelect = document.getElementById("monthSelect");
const komoditasSelect = document.getElementById("komoditasSelect");
const kegiatanSelect = document.getElementById("kegiatanSelect");
const fenomenaList = document.getElementById("fenomenaList");

/* ================= LOAD DROPDOWN ================= */
function loadMonth(){
  const bulanSet = [...new Set(data.map(d => d.bulan))];
  monthSelect.innerHTML = '<option value="">-- Pilih Bulan --</option>';
  bulanSet.forEach(b => {
    const o = document.createElement("option");
    o.value = b;
    o.textContent = b;
    monthSelect.appendChild(o);
  });
}

function loadKomoditas(){
  const set = [...new Set(data.map(d => d.komoditas))];
  komoditasSelect.innerHTML = '<option value="">-- Semua Komoditas --</option>';
  set.forEach(k => {
    const o = document.createElement("option");
    o.value = k;
    o.textContent = k;
    komoditasSelect.appendChild(o);
  });
}

function loadKegiatan(){
  const set = [...new Set(data.map(d => d.kegiatan))];
  kegiatanSelect.innerHTML = '<option value="">-- Semua Kegiatan --</option>';
  set.forEach(k => {
    const o = document.createElement("option");
    o.value = k;
    o.textContent = k;
    kegiatanSelect.appendChild(o);
  });
}

/* ================= FENOMENA ================= */
function updateFenomena(){
  fenomenaList.innerHTML = "";

  const filtered = data.filter(d =>
    (!monthSelect.value || d.bulan === monthSelect.value) &&
    (!komoditasSelect.value || d.komoditas === komoditasSelect.value) &&
    (!kegiatanSelect.value || d.kegiatan === kegiatanSelect.value)
  );

  document.getElementById("jumlahFenomena").textContent = filtered.length;
  document.getElementById("jumlahKomoditas").textContent =
    new Set(filtered.map(d => d.komoditas)).size;
  document.getElementById("bulanAktif").textContent =
    monthSelect.value || "-";

  filtered.forEach(d => {
    const selisih = d.hargaSekarang - d.hargaSebelum;
    const div = document.createElement("div");
    div.className = "fenomena-item";
    div.innerHTML = `
      <strong>${d.komoditas} â€“ ${d.kegiatan}</strong><br>
      Sebelum = ${d.hargaSebelum.toLocaleString()}<br>
      Sekarang = ${d.hargaSekarang.toLocaleString()}<br>
      Selisih = ${selisih.toLocaleString()}<br>
      <em>Fenomena: ${d.alasan}</em>
    `;
    fenomenaList.appendChild(div);
  });
}

/* ================= INIT ================= */
loadMonth();
loadKomoditas();
loadKegiatan();
updateFenomena();

monthSelect.addEventListener("change", updateFenomena);
komoditasSelect.addEventListener("change", updateFenomena);
kegiatanSelect.addEventListener("change", updateFenomena);
</script>

</body>
</html>
